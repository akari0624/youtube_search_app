{"version":3,"sources":["pages/VideoPlayer/styled.js","pages/VideoPlayer/index.js","logics/index.js","hooks/useGetNowScrollDirection/index.js","components/NavigatorHideOnScrollHeader/index.js"],"names":["VideoPlayer","styled","article","VideoPlayerPageVideoInfoWrapper","div","VideoInfo","itemData","className","snippet","title","description","parseISO8601DurationToTimes","duration","navigateBackCallback","history","goBack","VideoPlayerPage","props","location","state","useLayoutEffect","engine","flowplayer","clip","sources","type","src","goto","id","checkIsAddedInCollections","itemId","collectionsLiteral","window","localStorage","getItem","videoCollections","JSON","parse","getCollections","addToCollections","item","setItem","stringify","Object","create","collectionsObj","err","console","error","swal","fire","icon","titleText","text","message","removeVideoFromCollections","countPageCount","nowBounchDataCount","rowPerPage","pages","Math","floor","countSliceIndex","nowPage","countPerPage","lastPlusOneIndex","durationText","moment","_hours","hours","_minutes","minutes","_seconds","seconds","Number","useGetNowScrollDirection","thresholdHeight","useState","isScrollDown","setIsScrollDown","isScrollDownRef","useRef","previousScrollTopRef","_handleOnScroll","nowScrollTop","pageYOffset","log","current","abs","throttledHandleONScroll","_throttle","useEffect","addEventListener","removeEventListener","TopClimbUp","keyframes","topSlideDown","Title","h1","BackTo","TopBarHeaderWrapper","HideTopBarHeaderWrapper","HideableOnScrollHeader","children","useHistory","backToMainPage","evt","onClick"],"mappings":"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","file":"static/js/7.07ba5bde.chunk.js","sourcesContent":["import styled from \"styled-components\";\n\nexport const VideoPlayer = styled.article`\n  height: 85vh;\n  width: 100vw;\n  @media (max-width: 540px) {\n    height: 70vh;\n  }\n`;\n\nexport const VideoPlayerPageVideoInfoWrapper = styled.div`\n  .title {\n    font-size: 1.5rem;\n    margin-bottom: 0.3rem;\n  }\n\n  .description {\n    margin-bottom: 0.3rem;\n  }\n\n  .duration {\n  }\n`;\n","import React, { useLayoutEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useHistory } from \"react-router-dom\";\n// const flowplayer = require('flowplayer');\n// const engine = require('flowplayer-hlsjs');\nimport flowplayer from 'flowplayer';\nimport engine from 'flowplayer-hlsjs';\nimport { VideoPlayer, VideoPlayerPageVideoInfoWrapper } from './styled'\nimport { parseISO8601DurationToTimes } from 'logics';\nimport HideableOnScrollHeader from 'components/NavigatorHideOnScrollHeader'\nimport \"../../css/flowplayer/flowplayer.min.css\";\n\n\nconst VideoInfo = ({itemData}) => (\n  <VideoPlayerPageVideoInfoWrapper>\n    <h1 className=\"title\">{itemData.snippet.title}</h1>\n    <div className=\"description\">{itemData.snippet.description}</div>\n    <div className=\"duration\">{parseISO8601DurationToTimes(itemData.duration)}</div>\n  </VideoPlayerPageVideoInfoWrapper>\n)\n\n\nconst EXAMPLE_M3U8_URL = 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8'\n\nconst navigateBackCallback = (history) => {history.goBack()}\n\nfunction VideoPlayerPage(props) {\n  const {itemData} = props.location.state\nuseLayoutEffect(() => {\n  engine(flowplayer);\n\n  flowplayer('#videoPlayerContainer', {\n  clip: {\n    sources: [{\n      type: 'application/x-mpegurl',\n      src: EXAMPLE_M3U8_URL\n    }]\n  }\n});\n\n}, [])\n\n  return (\n    <>\n    <HideableOnScrollHeader goto={navigateBackCallback}>video player page</HideableOnScrollHeader>\n    <VideoPlayer id=\"videoPlayerContainer\"/>\n    <VideoInfo itemData={itemData} />\n      </>\n  );\n}\n\nVideoPlayerPage.propTypes = {};\n\nexport default VideoPlayerPage;\n","import swal from \"sweetalert2\";\nimport moment from 'moment'\n\nconst COLLECTIONs_KEY_IN_LOCAL_STORAGE = \"videoCollections\";\n\nexport const checkIsAddedInCollections = (itemId) => {\n  const collectionsLiteral = window.localStorage.getItem(\n    COLLECTIONs_KEY_IN_LOCAL_STORAGE\n  );\n  const videoCollections = collectionsLiteral && JSON.parse(collectionsLiteral)\n  const has = videoCollections && videoCollections[itemId];\n  return has;\n};\n\nexport const getCollections = () => {\n  const collectionsLiteral = window.localStorage.getItem(\n    COLLECTIONs_KEY_IN_LOCAL_STORAGE\n  );\n  const videoCollections = collectionsLiteral && JSON.parse(collectionsLiteral)\n  return videoCollections  // object\n};\n\n\nexport const addToCollections = (id, item) => {\n  try {\n    const _testIsCollectionsObjExit = window.localStorage.getItem(\n      COLLECTIONs_KEY_IN_LOCAL_STORAGE\n    );\n    if (!_testIsCollectionsObjExit) {\n      window.localStorage.setItem(\n        COLLECTIONs_KEY_IN_LOCAL_STORAGE,\n        JSON.stringify(Object.create(null))\n      );\n    }\n    const collectionsObj = JSON.parse(\n      window.localStorage.getItem(COLLECTIONs_KEY_IN_LOCAL_STORAGE)\n    );\n    collectionsObj[id] = item;\n\n    window.localStorage.setItem(\n      COLLECTIONs_KEY_IN_LOCAL_STORAGE,\n      JSON.stringify(collectionsObj)\n    );\n    return true;\n  } catch (err) {\n    console.error(\"add video to collections error:\", err);\n    swal.fire({\n      icon: \"error\",\n      titleText: \"添加收藏時發生錯誤\",\n      text: err.message,\n    });\n    return false;\n  }\n};\n\nexport const removeVideoFromCollections = (id) => {\n  const _testIsCollectionsObjExit = window.localStorage.getItem(\n    COLLECTIONs_KEY_IN_LOCAL_STORAGE\n  );\n  // edge case\n  if (!_testIsCollectionsObjExit) {\n    swal.fire({\n      icon: \"error\",\n      titleText: \"錯誤\",\n      text: \"目前沒有收藏\",\n    });\n    return;\n  }\n  const collectionsObj = JSON.parse(\n    window.localStorage.getItem(COLLECTIONs_KEY_IN_LOCAL_STORAGE)\n  );\n\n  try {\n    delete collectionsObj[id];\n\n    window.localStorage.setItem(\n      COLLECTIONs_KEY_IN_LOCAL_STORAGE,\n      JSON.stringify(collectionsObj)\n    );\n    return true;\n  } catch (err) {\n    console.error(\"remove video from collections error:\", err);\n    swal.fire({\n      icon: \"error\",\n      titleText: \"移除收藏時發生錯誤\",\n      text: err.message,\n    });\n    return false;\n  }\n};\n\nexport const countPageCount = (nowBounchDataCount, rowPerPage) => {\n  const pages = Math.floor(nowBounchDataCount / rowPerPage);\n  return nowBounchDataCount % rowPerPage > 0 ? pages + 1 : pages;\n};\n\nexport const countSliceIndex = (nowPage, countPerPage) => {\n  const lastPlusOneIndex = nowPage * countPerPage;\n  const startIndex = lastPlusOneIndex - countPerPage;\n\n  return [startIndex, lastPlusOneIndex];\n};\n\n\nexport const parseISO8601DurationToTimes = (durationText) => {\n  if(!durationText) {\n    return '無法取得影片長度'\n  }\n  const duration = moment.duration(durationText)\n  const _hours = duration.hours()\n  const _minutes = duration.minutes()\n  const _seconds = duration.seconds()\n   return `${Number(_hours) ? _hours+'時' : ''} ${Number(_minutes) ? _minutes+'分' : ''} ${Number(_seconds) ? _seconds+'秒': ''}`\n\n}\n","import React, { useEffect, useRef, useState } from \"react\";\nimport _throttle from 'lodash.throttle';\n\nexport function useGetNowScrollDirection(thresholdHeight = 30) {\n\n  const [isScrollDown, setIsScrollDown] = useState(false); // true 往下,  false 往上\n  const isScrollDownRef = useRef(false); // true 往下,  false 往上\n  const previousScrollTopRef = useRef(0);\n\n  const _handleOnScroll = () => {\n    const nowScrollTop = window.pageYOffset;\n    // !isScrollDownRef.current  是true的話代表滑動方向改變\n    console.log(\"nowScrollTop, previousScrollTopRef\", nowScrollTop, previousScrollTopRef.current)\n    // 用力拉到最上面的時候 previousScrollTopRef.current 會是負的 然後再稍微彈回來\n    if (nowScrollTop > previousScrollTopRef.current && !isScrollDownRef.current && previousScrollTopRef.current > 0) {\n      isScrollDownRef.current = !isScrollDownRef.current \n      setIsScrollDown(true);\n    } else if (nowScrollTop < previousScrollTopRef.current && isScrollDownRef.current) {\n      isScrollDownRef.current = !isScrollDownRef.current\n      setIsScrollDown(false);\n    }\n    if (\n       Math.abs(nowScrollTop - previousScrollTopRef.current) >= thresholdHeight\n    ) {\n       previousScrollTopRef.current = nowScrollTop;\n    }\n\n  };\n\n  const throttledHandleONScroll = _throttle(_handleOnScroll, 500)\n\n  useEffect(() => {\n    window.addEventListener(\"scroll\", throttledHandleONScroll);\n    return () => {\n      window.removeEventListener(\"scroll\", throttledHandleONScroll);\n    };\n  }, []);\n\n  return isScrollDown;\n}\n","import React from \"react\";\nimport styled, { keyframes } from \"styled-components\";\nimport { useHistory } from \"react-router-dom\";\nimport { useGetNowScrollDirection } from \"hooks/useGetNowScrollDirection\";\n\nconst TopClimbUp = keyframes`\n  from {\n    transform: translateY(0px); \n  }\n\n  to {\n    transform: translateY(-48px);\n  }\n`;\n\nconst topSlideDown = keyframes`\n  from {\n    transform: translateY(-48px); \n  }\n\n  to {\n    transform: translateY(0px);\n  }\n`;\n\nconst Title = styled.h1`\n  padding: 5px;\n  margin: 0;\n`\n\nconst BackTo = styled.div`\n  left: 20px;\n  font-size: 2em;\n  line-height: 48px;\n  cursor: pointer;\n  &:before {\n    content: '<';\n  }\n`\n\nconst TopBarHeaderWrapper = styled.div`\nposition: relative;\n  width: 100vw;\n  display: flex;\n  padding: 3px 0px;\n  justify-content: center;\n  z-index: 5;\n  @media (max-width: 740px) {\n    background: #ffffff;\n    position: fixed;\n    top: 0px;\n    animation: ${topSlideDown} 0.5s linear forwards;\n  }\n`;\n\nconst HideTopBarHeaderWrapper = styled.div`\nposition: relative;\n  width: 100vw;\n  display: flex;\n  padding: 3px 0px;\n  justify-content: center;\n  z-index: 5;\n  @media (max-width: 740px) {\n    background: #ffffff;\n    position: fixed;\n    top: 0px;\n    animation: ${TopClimbUp} 0.5s linear forwards;\n  }\n`;\n\n\nfunction HideableOnScrollHeader({children, goto}) {\n      const history = useHistory()\n      const backToMainPage =  (evt) => {\n        goto(history)\n      }\n  const isScrollDown = useGetNowScrollDirection();\n\n  return isScrollDown ? (\n    <HideTopBarHeaderWrapper>\n      <BackTo onClick={backToMainPage} /><Title>{children}</Title>\n    </HideTopBarHeaderWrapper>\n  ) : (\n    <TopBarHeaderWrapper>\n      <BackTo onClick={backToMainPage} /><Title>{children}</Title>\n    </TopBarHeaderWrapper>\n  );\n}\n\nHideableOnScrollHeader.propTypes = {};\n\nexport default HideableOnScrollHeader;\n"],"sourceRoot":""}